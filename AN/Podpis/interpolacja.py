import matplotlib.pyplot as plt

HEIGHT = 104
WIDTH = 634


Nx = [-252.7,-260.9,-255.7,-256.3, -259.9, -267.2, -282.6, -295.1, -297.5, -298.4, -296.6, -295.0, -295.1, -296.6]
Ny = [11.31, 19.45, -5.855, -22.82, -29.08, -27.89, -7.244, 13.50, 7.046, -18.26, -25.50, -18.66, 8.237, 11.21]

Ux = [-240.4, -239.9, -240.0, -238.4, -234.7, -229.9, -226.1, -223.0, -220.6, -219.8, -220.1, -221.8]
Uy = [-0.397, -6.252, -13.10, -20.44, -25.31, -26.79, -25.60, -22.33, -18.26, -11.71, -5.061, -1.290]

Mx = [-208.8, -208.8, -208.8, -207.7, -206.5, -204.5, -202.2, -200.7, -199.7, -197.4, -194.1, -190.5, -188.3, -188.3, -186.6, -182.9]
My = [-0.496, -7.244, -14.19, -16.27, -14.89, -9.031, -4.267, -3.076, -7.344, -10.62, -9.328, -5.260, -7.244, -9.725, -11.61, -14.69]

ERx = [-173.3, -171.0, -168.7, -164.1, -161.2, -158.9, -158.2, -158.8, -161.7, -163.9, -165.2, -166.7, -167.1, -167.7, -165.7, -163.0, -157.8, -153.9, -150.0, -148.3, -147.1, -147.2, -146.5, -145.0, -142.7, -139.4, -135.5]
ERy = [-5.656, -7.641, -10.12, -10.62, -10.12, -8.336, -3.473, -0.659, 1.588, -0.298, -2.580, -5.756, -8.237, -12.90, -17.47, -18.95, -19.45, -17.37, -12.90, -6.947, -2.084, -11.21, -18.66, -19.85, -15.28, -8.336, 0.000]

KIx = [-127.5, -124.4, -124.0, -126.0, -127.7, -127.3, -125.3, -121.5, -117.1, -113.6, -111.3, -111.2, -111.9, -111.2, -108.4, -103.7, -100.3, -98.24, -96.06, -94.37, -93.98, -94.97, -95.07, -94.37, -93.18]
KIy = [13.40, 16.87, 12.70, 6.252, -1.985, -9.328, -13.69, -15.08, -12.90, -9.427, -4.466, 0.794, -10.12, -15.08, -17.27, -17.17, -14.39, -11.02, -5.756, -0.794, 4.069, -3.374, -9.427, -12.80, -14.39]

KROPKAx = [-88.92, -88.42, -87.03, -87.92]
KROPKAy = [17.27, 15.78, 15.38, 17.27]

Sx = [-26.79, -28.08, -31.46, -34.34, -35.92, -33.54, -29.77, -25.11, -20.64, -16.27, -14.49, -15.38, -19.15, -24.61, -34.44]
Sy = [6.847, 9.031, 9.527, 8.336, 5.954, 1.687, -0.992, -3.176, -5.260, -7.046, -8.832, -10.22, -11.61, -12.21, -12.11]

Yx = [-2.878, -5.458, -6.153, -6.252, -5.359, -2.779, 1.290, 4.664, 6.153, 6.649, 4.267, 1.588, 6.450, 9.626, 12.31, 14.59, 16.18, 16.18, 14.09, 11.02, 9.229, 10.12, 13.99, 22.92]
Yy = [5.656, 7.542, 4.366, 1.489, -1.191, -4.168, -5.557, -3.573, -0.198, 1.687, 4.366, 6.450, 1.786, -9.924E-2, -1.786, -4.267, -8.137, -11.51, -15.18, -18.26, -20.74, -23.72, -24.21, -24.11]

SUx = [77.40, 78.89, 81.18, 84.35, 87.63, 90.01, 90.90, 89.11, 85.54, 81.47, 80.28, 80.68, 83.76, 88.02, 91.10, 94.87, 97.65, 100.0, 101.6, 101.9, 102.8, 105.0, 106.7, 109.2, 111.0, 112.9, 113.7, 113.9, 115.2, 115.7, 115.3, 114.3]
SUy = [10.42, 6.847, 3.771, 0.496, -2.779, -5.557, -8.336, -10.22, -11.02, -10.82, -9.328, -6.947, -4.962, -2.878, -2.481, 0.198, 1.489, 3.275, 7.840, 2.481, -0.298, -3.076, -4.664, -5.656, -5.756, -5.160, -3.275, 0.198, 2.779, 4.466, 6.550, 9.328]

Px = [124.9, 126.8, 128.2, 129.6, 130.4, 130.7, 130.9, 128.6, 126.6, 123.7, 121.5, 118.9, 117.5, 118.3, 119.8, 121.9, 125.3, 129.4, 133.6, 138.8, 141.7, 141.2, 138.4, 135.2, 131.5]
Py = [7.542, 9.924, 6.847, 0.397, -7.244, -13.40, -22.43, -29.97, -36.22, -39.30, -39.30, -36.22, -31.16, -24.81, -16.27, -7.443, 1.389, 8.931, 12.01, 12.50, 8.634, 3.176, -0.893, -4.366, -8.336]

ER2x = [150.2, 152.9, 156.6, 160.1, 162.6, 164.3, 165.5, 163.4, 159.9, 156.8, 153.8, 152.3, 151.7, 152.9, 154.4, 157.8, 162.2, 166.1, 170.2, 174.8, 177.9, 180.8, 181.8, 180.3, 182.0, 186.6, 190.8, 193.9, 196.9, 198.2]
ER2y = [5.855, 2.679, 0.198, 0.397, 2.282, 4.863, 10.22, 12.90, 12.90, 10.12, 6.947, 2.878, -3.176, -6.550, -8.336, -9.725, -8.336, -4.863, 0.000, 5.260, 11.11, 13.89, 7.145, -1.985, -5.061, 9.924E-2, 4.863, 9.527, 13.10, 15.88]

OKO1x = [243.1, 242.3, 244.8, 243.6]
OKO1y = [17.25, 13.83, 14.92, 17.42]

OKO2x = [243.6, 246.3, 247.4, 246.5]
OKO2y = [0.833, -0.667, 0.583, 2.000]

NOSx = [253.4, 255.8, 257.9, 260.6, 262.1]
NOSy = [9.917, 9.833, 9.750, 9.417, 9.000]

USTAx = [265.8, 267.5, 269.4, 270.3, 271.8, 272.5, 272.6, 272.5, 271.2, 269.8, 267.9]
USTAy = [25.00, 23.83, 20.83, 18.00, 14.33, 11.08, 6.333, 2.917, 0.417, -2.000, -4.000]

litery = [(Nx, Ny), (Ux, Uy), (Mx, My), (ERx, ERy), (KIx, KIy), (KROPKAx, KROPKAy), (Sx, Sy),
          (Yx, Yy), (SUx, SUy), (Px, Py), (ER2x, ER2y), (OKO1x, OKO1y), (OKO2x, OKO2y), (NOSx, NOSy), (USTAx, USTAy)]
def interpolMatrix(values):
  def points(x):
    return x/len(values)
  
  n = len(values) - 1
  q = [0 for i in range(n)]
  u = [0 for i in range(n)]
  p = [0 for i in range(n)]
  m = [0 for i in range(n+1)]
  q[0] = 0
  u[0] = 0

  def h(k):
    return points(k) - points(k-1)
  
  def lam(k):
    return h(k)/(h(k)+h(k+1))
  
  def f(a,b):
    if a == b:
      return values[a]
    return (f(a+1,b) - f(a,b-1))/(points(b)-points(a))
  
  def d(k):
    return 6*f(k-1,k+1)

  for k in range(1,n-1):
    p[k] = 2+(q[k-1]*lam(k))
    q[k] = (lam(k)-1)/p[k]
    u[k] = (d(k)-lam(k)*u[k-1])/p[k]
  
  m[n] = 0

  for k in range(n-1,1,-1):
    m[k] = u[k] + q[k]*m[k+1]
  
  return m


def interpolValue(x, values, m):
  n = len(values) - 1

  def points(x):
    return x/len(values)

  def h(k):
    return points(k) - points(k-1)

  i = n-1
  while x - points(i) < 0:
    i = i-1

  a = (m[i+1]-m[i])/(6*h(i))
  b = m[i]/2
  c = (((values[i+1] - values[i])/h(i)) - (h(i)*(m[i+1]+2*m[i])/6))
  s = values[i] + (x-points(i))*(c+(x-points(i))*(b+(x-points(i))*a))
  return s


M = 1000
fig, ax = plt.subplots(figsize=(12.4803, 2.04724))
ax = fig.add_axes((0, 0, 1, 1))
ax.set(ylim=(-HEIGHT/2,HEIGHT/2),       
       xlim=(-WIDTH/2,WIDTH/2),
       yticks=[],
       xticks=[])
       
out = open("dane.txt", "wt")

itr = 0
for litera in litery:
  literaX = [0 for i in range(M)]
  literaY = [0 for i in range(M)]
  
  mx = interpolMatrix(litera[0])
  my = interpolMatrix(litera[1])
  for i in range(M):
    literaX[i] = interpolValue(i/M, litera[0], mx)
    literaY[i] = interpolValue(i/M, litera[1], my)

  ax.plot(literaX, literaY)
  out.write(f'''krzywa{itr}:\n
            Xn = {litera[0]}\n
            Yn = {litera[1]}\n
            tn = {[k/len(litera[0]) for k in range(len(litera[0]))]}\n
            un = {[k/M for k in range(M)]}\n\n''')
  itr +=1


fig.savefig("output.png")
plt.show()
